"use strict";const e=require("../../common/vendor.js"),t={data:()=>({warteringimageSrc:"../../static/deviceCard/startwartering.png",connectStatusScr:"../../static/deviceCard/wifi_disconnect.png",connectStatus:"离线"}),props:{device:{deviceSN:String,deviceName:String,devicePlace:String}},mounted(){setInterval((()=>{this.getDeviceConnectionStatus()}),5e3)},methods:{onWaterring(e){console.log("send tcp message",e),this.sendTcpMessage(e,"on"),this.warteringimageSrc="../../static/deviceCard/stopwartering.png"},stopWaterring(e){this.sendTcpMessage(e,"off"),this.warteringimageSrc="../../static/deviceCard/startwartering.png"},sendTcpMessage(t,c){e.index.request({url:"https://apis.bemfa.com/va/postmsg",method:"POST",data:{uid:"c2421290f7d14fa38251e5f77aac931a",topic:this.device.deviceSN,type:3,msg:c},header:{"content-type":"application/x-www-form-urlencoded"},success:e=>{console.log("发送成功")}})},deleteDevice(){console.log("delete",this.device);const t=this.device;e.index.showModal({title:"删除设备",content:"是否确认要删除该设备？",success:function(c){c.confirm?(console.log("用户点击确定",t),e.Ws.callFunction({name:"deleteDevice",data:{device:t}}).then((c=>{0!=c.result.code?console.log("deleteDevice Fail，",c.result.msg):e.index.$emit("deleteDevice",t.deviceSN)}))):c.cancel&&console.log("用户点击取消")}})},async getDeviceConnectionStatus(){try{e.index.request({url:"https://apis.bemfa.com/va/online",method:"GET",data:{uid:"c2421290f7d14fa38251e5f77aac931a",topic:this.device.deviceSN,type:3},header:{"content-type":"application/x-www-form-urlencoded"},success:e=>{0==e.data.code&&(1==e.data.data?(this.connectStatusScr="../../static/deviceCard/connect.png",this.connectStatus="z在线"):(this.connectStatusScr="../../static/deviceCard/wifi_disconnect.png",this.connectStatus="离线"))}})}catch(t){console.error("获取设备连接状态失败：",t)}}}};const c=e._export_sfc(t,[["render",function(t,c,i,n,a,s){return{a:e.t(i.device.deviceSN),b:e.t(i.device.deviceName),c:e.t(i.device.devicePlace),d:a.connectStatusScr,e:e.t(a.connectStatus),f:a.warteringimageSrc,g:e.o((e=>s.onWaterring(i.device))),h:e.o((e=>s.stopWaterring(i.device))),i:e.o(((...e)=>s.deleteDevice&&s.deleteDevice(...e)))}}]]);wx.createComponent(c);
